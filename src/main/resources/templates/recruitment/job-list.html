<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Job Openings - ATS</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" th:href="@{/assets/css/style.css}">
</head>
<body>
    <div class="app-shell">
        <!-- Header -->
        <header class="app-header">
            <div class="app-header-content">
                <div class="app-logo">
                    <div class="app-logo-icon">
                        <i class="fas fa-briefcase"></i>
                    </div>
                    <span>Job Openings</span>
                </div>
                <nav class="app-nav">
                    <div class="app-nav-user">
                        <div class="app-nav-user-avatar">
                            <i class="fas fa-user"></i>
                        </div>
                        <span th:text="${username}">User</span>
                    </div>
                    <a href="/ats/logout" class="app-nav-link">
                        <i class="fas fa-sign-out-alt"></i> Log Out
                    </a>
                </nav>
            </div>
        </header>

        <!-- Hero Section -->
        <div style="background: linear-gradient(135deg, var(--primary-600), var(--primary-800)); padding: var(--space-12) var(--space-6); text-align: center; color: white;">
            <h1 style="font-size: var(--text-3xl); font-weight: var(--font-bold); margin-bottom: var(--space-3);">
                <i class="fas fa-briefcase" style="margin-right: var(--space-3);"></i>
                Current Job Openings
            </h1>
            <p style="font-size: var(--text-lg); opacity: 0.9; max-width: 600px; margin: 0 auto;">
                Join our team and grow your career with us
            </p>
        </div>

        <!-- Main Content -->
        <main class="app-content">
            <div class="content-container">
                <!-- Empty State -->
                <div th:if="${jobs.isEmpty()}" class="card">
                    <div class="empty-state">
                        <div class="empty-state-icon">
                            <i class="fas fa-search"></i>
                        </div>
                        <h3 class="empty-state-title">No Active Positions</h3>
                        <p class="empty-state-description">
                            We currently don't have any open positions, but check back soon for new opportunities!
                        </p>
                    </div>
                </div>

                <!-- Jobs Grid -->
                <div class="jobs-grid">
                    <article th:each="job : ${jobs}" class="job-card">
                        <div class="job-card-header">
                            <h2 class="job-card-title" th:text="${job.jobTitle}">Job Title</h2>
                            <div class="job-card-meta">
                                <span class="badge badge-success">
                                    <i class="fas fa-map-marker-alt"></i>
                                    <span th:text="${job.location}">Location</span>
                                </span>
                                <span class="badge badge-warning">
                                    <i class="fas fa-clock"></i>
                                    <span th:text="${job.jobType}">Job Type</span>
                                </span>
                                <span class="badge badge-primary">
                                    <i class="fas fa-user-tie"></i>
                                    <span th:text="${job.experienceRequired}">Experience</span>
                                </span>
                            </div>
                        </div>

                        <div class="job-card-body">
                            <div class="job-card-section">
                                <h4 class="job-card-section-title">Role Overview</h4>
                                <p class="job-card-description" th:text="${job.jobDescription}">Description</p>
                            </div>

                            <div class="job-card-section">
                                <h4 class="job-card-section-title">Required Skills</h4>
                                <div class="job-card-skills">
                                    <span class="skill-tag" th:text="${job.requiredSkills}">Skills</span>
                                </div>
                            </div>
                        </div>

                        <div class="job-card-footer">
                            <div class="job-card-date" th:if="${job.postedOn != null}">
                                <i class="fas fa-calendar-alt"></i>
                                <span>Posted on <span th:text="${job.postedOn}">Date</span></span>
                            </div>

                            <div class="job-card-actions">
                                <a th:href="@{/recruitment/job/{id}(id=${job.jobId})}" class="btn btn-secondary btn-sm">
                                    <i class="fas fa-eye"></i> View Details
                                </a>
                                <a th:href="@{/recruitment/apply/{id}(id=${job.jobId})}" class="btn btn-primary btn-sm">
                                    <i class="fas fa-paper-plane"></i> Apply Now
                                </a>
                            </div>
                        </div>
                    </article>
                </div>
            </div>
        </main>
    </div>

    <!-- Success message popup -->
    <div th:if="${success}" style="display: none;" id="successMessage" th:text="${success}"></div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const successElement = document.getElementById('successMessage');
            if (successElement && successElement.textContent.trim()) {
                showSuccessPopup();
            }
        });

        function showSuccessPopup() {
            const overlay = document.createElement('div');
            overlay.className = 'modal-overlay active';

            const popup = document.createElement('div');
            popup.className = 'modal';
            popup.style.maxWidth = '450px';
            popup.style.textAlign = 'center';
            popup.innerHTML = `
                <div class="modal-body" style="padding: var(--space-8);">
                    <div style="color: var(--success-500); font-size: 64px; margin-bottom: var(--space-4);">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <h2 style="font-size: var(--text-xl); font-weight: var(--font-bold); color: var(--gray-900); margin-bottom: var(--space-3);">
                        Application Submitted Successfully!
                    </h2>
                    <p style="color: var(--gray-600); margin-bottom: var(--space-6); line-height: 1.6;">
                        Your application has been submitted and our AI will screen your resume.
                        You'll be notified about the next steps soon.
                    </p>
                    <button onclick="closeSuccessPopup()" class="btn btn-primary">
                        <i class="fas fa-check"></i> Got it!
                    </button>
                </div>
            `;

            overlay.appendChild(popup);
            document.body.appendChild(overlay);

            window.closeSuccessPopup = function() {
                overlay.classList.remove('active');
                setTimeout(() => {
                    if (document.body.contains(overlay)) {
                        document.body.removeChild(overlay);
                    }
                }, 200);
            };

            overlay.addEventListener('click', function(e) {
                if (e.target === overlay) closeSuccessPopup();
            });

            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') closeSuccessPopup();
            });
        }
    </script>
</body>
</html>